FROM node:22-slim

# Install sqlite3 (required dependency)
RUN apt-get update && apt-get install -y sqlite3 && rm -rf /var/lib/apt/lists/*

# Copy plugin source
WORKDIR /plugin
COPY index.js openclaw.plugin.json ./
COPY lib/ lib/

# Create a standalone Docker smoke test (no live DB dependency)
COPY test/docker-smoke.mjs test/docker-smoke.mjs

# Run smoke test
CMD ["node", "test/docker-smoke.mjs"]
